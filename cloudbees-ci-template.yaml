#required
domain: example.org
ipAddress: 1.1.1.1
adminEmail: admin@example.org
license:
  key: |
    -----BEGIN RSA PRIVATE KEY-----
    abc 
    -----END RSA PRIVATE KEY-----
  cert: |
    -----BEGIN CERTIFICATE-----
    xyz
    -----END CERTIFICATE-----
---
#optional (below are the defaults)
https:
  enabled: false
cjoc:
  version:
  initialCapPlugins:
  - antisamy-markup-formatter
  - blueocean-rest
  - bluesteel-cjoc
  - cloudbees-jenkins-advisor
  - cloudbees-ssh-slaves
  - ldap
  - matrix-project
  - operations-center-jnlp-controller
  - operations-center-rbac
  - pubsub-light
  - sse-gateway
  - suppress-stack-trace
  initialExtraPlugins:
  - configuration-as-code
security:
  # enable the pod security policy. Cannot run as root. If you need this, then use gvisor.
  podSecurityPolicy:
    enabled: true
  # this allows running as "root" in a more secure way. Uses gvisor(runsc) as a userspace kernel.
  gvisor:
    enabled: true
    nodeLabel: "gvisor"
isolation:
  # NOT IMPLEMENTED YET
  # Enabled by default. This will put CJOC in its own namespace and any builds from CJOC in their own namespace.
  # By default, each master will get its own namespace, and each master's builds will get their own namespace.
  # These isolations can be reduced.
  enabled: true
  cjoc:
    enabled: true
  masters:
    enabled: true
    # defaults to EachMaster. Less isolated would be "AllMastersTogether".
    level: EachMaster
    builds:
      enabled: true
      # defaults to "EachMastersBuilds". Less isolated would be "AllMastersBuildsTogether".
      level: EachMastersBuilds
#examples of how to define master templates and masters
masters:
  defaultMasterTemplate:
    provisioning:
      disk: 5
      memory: 4096
    bundle:
      jcasc:
        jenkins:
          systemMessage: "Jenkins configured using default master template."
      plugins:
        - id: "maven-plugin"
        - id: "configuration-as-code"
        - id: "github-branch-source"
        - id: "cloudbees-groovy-view"
        - id: "cloudbees-jsync-archiver"
        - id: "cloudbees-monitoring"
        - id: "cloudbees-nodes-plus"
        - id: "cloudbees-ssh-slaves"
        - id: "cloudbees-template"
        - id: "cloudbees-view-creation-filter"
        - id: "cloudbees-workflow-template"
        - id: "cloudbees-workflow-ui"
        - id: "email-ext"
        - id: "git"
        - id: "infradna-backup"
        - id: "ldap"
        - id: "operations-center-cloud"
        - id: "pipeline-model-extensions"
        - id: "pipeline-stage-view"
        - id: "wikitext"
        - id: "workflow-aggregator"
        - id: "workflow-cps-checkpoint"
        - id: "job-dsl"
      pluginCatalog:
        type: "plugin-catalog"
        version: "1"
        name: "must-have-catalog"
        displayName: "Must Have Master Catalog"
        configurations:
        - description: "Important plugins"
          includePlugins:
            job-dsl: {version: 1.77}
    appIds: []
  masterTemplates:
    basic-a:
      provisioning:
        memory: 5120
      bundle:
        jcasc:
          jenkins:
            systemMessage: "Jenkins configured using CasC bundle template: basic-a."
          jobs:
          - script: |
              folder('project-a') {
                  displayName('Project A')
                  description('Folder for project A')
              }
    basic-b:
      bundle:
        jcasc:
          jenkins:
            systemMessage: "Jenkins configured using CasC bundle template: basic-b."
          jobs:
          - script: |
              folder('project-b') {
                  displayName('Project B')
                  description('Folder for project A')
              }

  masterDefinitions:
    specificMasters:
    - name: master0
      masterTemplate: default
    - name: master1
      masterTemplate: basic-a
      appIds:
        - "AB"
        - "AC"
    - name: master2
      masterTemplate: basic-a
      appIds:
        - "AF"
    - name: master3
      masterTemplate: basic-a
      appIds:
        - "AD"
        - "AE"
    - name: master4
      masterTemplate: basic-a
      provisioning:
        disk: 10
        # TODO: make this work!!!!!!!!!!!!
      bundle:
        jcasc:
          jenkins:
            systemMessage: "overridden"
          jobs:
          - script: | 
              organizationFolder('app-AG') {
                description("Attempt to automatically create GH org")
                displayName('Auto-created gh org')
                organizations {
                  github {
                    repoOwner("cbci-helmfile-org")
                    credentialsId("cbci-helmfile-bot-token")
                    traits {
                      teamSlugFilter {
                        teamSlug('app-AG')
                        gitHubBranchDiscovery {
                          strategyId(0)
                        } 
                        gitHubPullRequestDiscovery {
                          strategyId(0)
                        }
                      }
                    }
                  }
                }
                triggers {
                  cron('@daily')
                }
              }
      appIds:
        - "AG"
        - "AH"
    manyMasters:
    # - prefix: red
    #   masterTemplate: default
    #   quantity: 2
    - prefix: green
      masterTemplate: basic-a
      quantity: 1 
    - prefix: blue
      masterTemplate: default
      quantity: 2
